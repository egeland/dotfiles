- clean: ['~']

- link:
    ~/.gitconfig: gitconfig
    ~/.ssh/config:
        path: ssh/config
        create: true
    ~/.local/share/konsole/Fish.profile:
        path: konsole/Fish.profile
        create: true
    ~/.local/share/konsole/Bash.profile:
        path: konsole/Bash.profile
        create: true
    ~/.config/yakuakerc:
        path: konsole/yakuakerc
        create: true
    ~/bin:
        path: bin/
        create: true
    ~/.config/fish:
        path: shells/fish
        create: true
        force: true
    ~/.gnupg/gpg.conf:
        path: gnupg/gpg.conf
        create: true
    ~/.gnupg/gpg-agent.conf:
        path: gnupg/gpg-agent.conf
    ~/.config/starship.toml:
        path: starship/starship.toml

- shell:
    -
        description: Ensure we have sudo
        command: sudo -v
        stdin: true
        stdout: true
    -
        description: APT Update
        command: sudo apt update --yes --quiet
    -
        description: APT Upgrade
        command: sudo apt full-upgrade --yes --quiet
    -
        description: APT Cleanup
        command: sudo apt autoremove --yes --quiet
    -
        description: APT Install
        command: sudo apt install --yes --quiet $(cat apt/packages.txt)
        stdout: true
        stdin: true
    -
        description: Set up python virtual env
        command: ./python/install.sh
        stdout: true
        stdin: true
    -
        description: Set up starship prompt
        command: which starship || curl -fsSL https://starship.rs/install.sh | bash
        stdout: true
        stdin: true
    -
        description: Set up zoxide
        command: which zoxide || curl --proto '=https' --tlsv1.2 -sSf https://raw.githubusercontent.com/ajeetdsouza/zoxide/master/install.sh | sh
        stdout: true
        stdin: true
    -
        description: Install Bitwarden CLI
        command: which bw || sudo snap install bw
        stdout: true
    -
        description: Retrieve SSH keys
        command: ./ssh/install.sh
        stdin: true
        stdout: true
    -
        description: Decode GPG secret key
        command: ./gnupg/install.sh
        stdin: true
        stdout: true
    -
        description: Set up trackball
        command: ./trackball/install.fish
        stdin: true
        stdout: true
    -
        description: Set up VS Code
        command: ./vscode/install.sh
        stdin: true
        stdout: true
    -
        description: Install delta
        command: which delta || (curl -fsSL -o /tmp/delta.deb https://github.com/dandavison/delta/releases/download/0.4.1/git-delta_0.4.1_amd64.deb && sudo apt install -f /tmp/delta.deb && rm -f /tmp/delta.deb)
        stdout: true
        stdin: true
    -
        description: Install lsd
        command: which lsd || (curl -fsSL -o /tmp/lsd.deb https://github.com/Peltoche/lsd/releases/download/0.17.0/lsd_0.17.0_amd64.deb && sudo apt install -f /tmp/lsd.deb && rm -f /tmp/lsd.deb)
        stdout: true
        stdin: true
    -
        description: Install nvm
        command: which nvm || (curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash)
        stdout: true
        stdin: true
    -
        description: Install fonts
        command: ./fonts/install.sh
    -
        description: Install Headset
        command: which headset || sudo snap install headset
        stdout: true
